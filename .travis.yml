---
language: bash
sudo: require
dist: xenial
before_install:
  # Install Ansible repository.
  - sudo apt -y update -q && sleep 1 && sudo apt-get upgrade -y
  - sudo apt -y install -y software-properties-common
  - sudo apt-add-repository -y ppa:ansible/ansible
  - wget -q https://www.virtualbox.org/download/oracle_vbox_2016.asc -O- | sudo apt-key add -
  - sudo sh -c 'echo "deb http://download.virtualbox.org/virtualbox/debian $(lsb_release -cs) contrib" >> /etc/apt/sources.list.d/virtualbox.list'
  - wget https://releases.hashicorp.com/packer/1.2.3/packer_1.2.3_linux_amd64.zip
  - unzip packer_1.2.3_linux_amd64.zip -d packer
  - ./packer/packer --version
  - sudo cp packer/packer /usr/bin/

  # Install Ansible.
  - sudo apt -y update
  - sudo apt -y install ansible
  - sudo apt -y intall virtualbox-5.2
  - sudo adduser $USER vboxusers
  - newgrp - vboxusers
script:
  - ansible-playbook -i localhost, --syntax-check check_box.yml
  - packer --version
