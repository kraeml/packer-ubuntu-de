---
  - name: "Check box {{box_name}} is in version {{box_version}}"
    command: "vagrant box add --box-version {{box_version}} {{box_name}}"
    register: box_info
    ignore_errors: yes
    changed_when: False

  - name: "Display box info"
    debug:
      var: box_info
      verbosity: 1

  - name: "Display box path"
    debug:
      var: box_ovf_path
      verbosity: 1

  - name: "Test box exists"
    command: "ls -ld {{box_ovf_path}}"
    args:
      creates: "{{box_ovf_path}}"

  - name: Ensure virtualbox-ovf directory exists
    file:
      path: "./virtualbox-ovf/{{BASE}}"
      state: directory

  - name: "Copy virtualbox files"
    copy:
      dest: "./virtualbox-ovf/{{BASE}}"
      src: "{{box_ovf_path}}"
